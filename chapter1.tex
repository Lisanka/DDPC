\chapter{ОСНОВНЫЕ ПОНЯТИЯ И ОБЗОР ЛИТЕРАТУРЫ }\label{chap1}
В этой главе мы приведём основные понятия поведенческой теории динамических систем, а также осветим последние результаты, полученные с помощью инструментов этой теории.

Прежде чем приступить к основной задаче данной главы, условимся о нетороых обозначениях, которые мы будем использовать на протяжении работы.


%%%%%%%%%%%%%%%%%%%%%
\section{Основные обозначения}\label{notations}
Через $[x, y]$ условимся обозначать матрицу, состоящую из векторов-столбцов $x,y$, тогда как $(x, y)$ являет собой укороченную форму записи $[x^T, y^T]^T$, т.е. два столбца, склеенных в один.Будем использовать краткое обозначение $u_t$ для вектора сигналов $u_t = (u(0), u(1), \ldots, u(t-1))$. Линейную оболочку столбцов матрицы $A$ будем обозначать $colspan(A)$. Евклидову норму и $l_\infty-$норму $x$ обозначаем через  $\norm{x}$ и $\norm{x}_\infty$ соответственно. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Поведенческая теория линейных стационарных систем}\label{1sec:behavioral}
Вместо того, чтобы, в традициях физики, отталкиваться от понимания внутренней организации системы, от детальных взаимосвязей её компонентов, можно концентрироваться на \textit{поведении} системы, на её взаимодействии с окружением. Эта идея находит отражение в поведенческой теории систем (behavioral systems theory в западной литературе). В рамках этой теории система описывается не через набор дифференциальных или разностных уравнений для входных и выходных сигналов, но через её поведение --- пространство всех возможных траекторий. Такой подход великолепно соотносится с нуждами растущего раздела системного анализа и управления, методы которого основаны прежде всего на собранных данных (data-based approaches в западной литературе).

В такой манере, следуя работам Willems в области поведенческой теории, определим динамическую систему, а затем высветим связи этого определения с одним из основных методов описания динамической системы --- через пространство состояний.  

Начнём с приведения основных положений поведенческой теории линейных стационарных систем, релевантных для нас в последующем, следуя работам Willems.

\begin{definition}
\textit{Динамическую систему} определим как тройку $(\mathbb{Z}_{\geq 0}, \mathbb{W}, \mathcal{B})$, где $\mathbb{Z}_{\geq 0 }$ - дискретная временная ось, $\mathbb{W}$ - пространство сигналов, $\mathcal{B} \subset \mathbb{W}^{\mathbb{Z}_{\geq 0}}$ - поведение.
\end{definition}
В сущности, поведение представляет собой не что иное как множество всех возможных траекторий системы.
На протяжении данной работы мы имеем дело именно с дискретными во времени системами. Более того, мы сконцентрируемся на линейных стационарных системах.

\begin{definition}
Динамическая система $(\mathbb{Z}_{\geq 0}, \mathbb{W}, \mathcal{B})$ является \textit{линейной}, если $\mathbb{W}$ - векторное пространство, $\mathcal{B}$ - линейное подпространство пространства $\mathbb{W}^{\mathbb{Z}_{\geq 0}}$. Система является \textit{стационарной}, если $\mathcal{B} \subset \sigma \mathcal{B}$, где $\sigma: \mathbb{W}^{\mathbb{Z}_{\geq 0}} \to \mathbb{W}^{\mathbb{Z}_{\geq 0}}$~-- сдвиг вперёд во времени, определённый как $(\sigma w)(t) = w(t+1)$, а $\sigma \mathcal{B} = \{\sigma w | w \in \mathcal{B}\}$.
\end{definition}

Для всех систем, рассматриваемых нами, $\mathbb{W} = \mathbb{R}^{m+p}$, представление $m+p$ именно в виде суммы будет объяснено в последующем. Без ограничения общности, систему далее будем определять как её поведение $\mathcal{B}.$

Введём в рассмотрение множество всех возможных "обрезанных" траекторий длины $T$, $\mathcal{B}_T = \{w \in (\mathbb{R}^{m+p})^T \quad| \exists v \in \mathcal{B}, w(t) = v(t), 1 \leq t \leq T\}.$ Такие траектории будем называть \textit{конечными длины} $T.$ Последовательность вида $w(t), w(t+1), \ldots, w(t+T-1)$ будем называть \textit{окном длины} $T$.

Возникает естественный вопрос: насколько информативной может быть одна-единственная конечная траектория системы? Так, из линейности системы непосредственно следует, что линейная оболочка наблюдаемых нами окон длины $t$ в траектории длины $T$ является подмножеством всех возможных траекторий длины $t$. Существует ли условия, при которых верно обратное включение? В работе \cite{Willems} доказано, что такие условия действительно существуют.

Первая составляющая -- управляемость системы. Это привычное понятие определяется следующим образом.
\begin{definition}
Система $\mathcal{B}$ является \textit{управляемой}, если для каждого $\mathbb{Z}_{\geq 0}, w^1 \in \mathcal{B}_T, w^2 \in \mathcal{B}$ существует $w \in \mathcal{B}$ и $T' \in \mathbb{Z}_{\geq 0}$ такие, что $w(t) = w(t)^1$ для $0 \leq t \leq T$ $w(t) = w^2(t-T-T')$ для $t > T + T'$. 
\end{definition}
Другими словами, поведенческая система управляема, если любые две траектории могут быть склеены в некоторой конечной точке времени.

Вторая составляющая -- наличие достаточно "богатой" компоненты $u \in \mathbb{R}^{m \times T}$ сигнала $w  \in \mathbb{R}^{(m+p)\times T}$. Компоненту $u$ будем будем именовать входной, а оставшуюся компоненту $y \in \mathbb{R}^{p \times T}$ сигнала $w = (u, y)$ --- выходной.

\begin{definition}\label{persistency exciting}
Пусть $t,T \in \mathbb{Z}_{ \geq 0}, \quad T \geq t$. Сигнал $u = (u(0), \cdots, u(T-1)) \in \mathbb{R}^{mT}$ является \textit{устойчиво возбуждённым порядка $t$}, если соответствующая матрица Ганкеля \[H_t(u) = 
\begin{pmatrix}
  u(0) & \cdots & u(T-t)\\
  \vdots & \ddots & \vdots \\
  u(t-1) & \cdots & u(T-1)
\end{pmatrix}
\]
имеет полный строчный ранг.
\end{definition}
Как мы убедимся далее, устойчиво возбуждённые сигналы достаточно высокого порядка возмущают систему таким образом, что выходные сигналы репрезентативны для поведения системы. Центральный результат работы \cite{Willems} указывает, какого порядка возбуждённости достаточно.

%TODO define system order n(\mathcal{B})
\begin{theorem}\label{fundamental theorem}
Рассмотрим управляемую систему $\mathcal{B}$ порядка $n(\mathcal{B}).$ Пусть $T, t \in \mathbb{Z}_{\geq 0}$ и $w = (u, y) \in \mathcal{B}_T$. Тогдая для любого устойчиво возбуждённого порядка $t + n(\mathcal{B})$ сигнала $u$ $colspan(H_t(w)) = \mathcal{B}_t.$
\end{theorem}
Последние результаты показывают, что для некоторых задач условие устойчивой возбуждённости можно ослабить\cite{Waarde}, однако это направление пока лишь зарождается, тогда вокруг теоремы \ref{fundamental theorem} уже накопилось достаточно солидных результатов. 

Соотнесём поведенческую теорию с классическим подходом пространства состояний, следуя работам \cite{Berberich}, \cite{Coulson}. 
\begin{definition}\label{trajectory def}
\textit{Траекторией} линейной системы $G$, минимальная реализация которой -- четвёрка $(A, B, C, D)$, будем называть такие $\{u(t), y(t)\}_{t=0}^{T-1}$, что существует некоторое исходное состояние $x_0$, для которого 
$$x(t+1) = Ax(t) + Bu(t), x(0) = x_0,$$
$$y(t) = Cx(t) + Du(t),$$
$$t = 0, \ldots, T-1.$$
\end{definition}
Понятие траектории системы на протяжении данной работы будет употребляться только в вышеобозначенном смысле -- как траектория входных-выходных сигналов, вместо $\{u(t), y(t)\}_{t=0}^{T-1}$ будем зачастую пользоваться более лаконичной записью $\{u_T, y_T\}.$

Фундаментальная теорема \ref{fundamental theorem} получила непосредственный перевод на язык классических моделей в пространстве состояний \cite{Berberich}.
\begin{theorem}\label{trajectory check}
Пусть $\{u^d(t), y^d(t)\}_{t=0}^{T^d-1}$ траектория линейной системы $G$, причем $u^d$ -- устойчиво возбуждённый сигнал порядка $T+n$. Тогда $\{u(t), y(t)\}_{t=0}^{T-1}$ является траекторией $G$ в том и только в том случае, когда для 
\begin{equation}
\begin{pmatrix}
H_T(u^d) \\
H_T(y^d)
\end{pmatrix} \alpha = \begin{pmatrix}
u \\
y
\end{pmatrix}
\end{equation}
существует решение $\alpha \in \mathbb{R}^{T^d-T+1}.$
\end{theorem}

\begin{remark}
Важнейшие результаты данной главы налагают на рассматривуемую систему требование быть управляемой. Ограничением это, впрочем, для нас не является: в последующей работе будем пользоваться тем, что каждая линейая стационарная система допускает некоторую минимальную реализацию, являющуюся управляемой. Именно такой минимальной реализацией и будем пользоваться во всех разделах по умолчанию, что даст возможность использования вышеперечисленных результатов. 
\end{remark}

%TODO references
Теорема \ref{fundamental theorem} привлекла интерес научного сообщества и породила множество замечательных результатов как в системном анализе, так и в оптимальном управлении. Были получены модификации метода MPC (Model Predictive Control), в которых собственно модель в явном виде отсутствует, динамика системы неявно задаётся её траекториями. В ряде работ представлены data-driven методики стабилизации систем. Что до системного анализа, то, к примеру, в представлен одношаговый метод проверки системы на диссипативность. Помимо того, некоторые результаты уже получены и для нелинейных систем, хотя в этом направлении продвижение в целом не столь велико. Помимо нелинейных систем, мало изучен в разрезе поведенческой методологии случай, когда траектории известны неточно.

\bigskip

В нашей работе мы представим ещё одну задачу управления, для которой применение теоремы \ref{fundamental theorem} позволяет получить неклассический метод решения, не требующий явного параметрического описания системы.  




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
Первая глава всегда посвящена обзору литературы. В начале каждой главы необходимо написать небольшую аннотацию о содержании главы (так называемая \textit{врезка}). Например:

В настоящей глава формулируются основные понятия, используемые в диссертации. Приводится классификация (согласно работе \cite{GabasovKirillovaPU}) принципов управления, используемых в современной теории управления. Объясняется принцип управления в режиме реального времени в применении к реализации оптимальных обратных связей в задачах оптимального управления с конечным горизонтом планирования \cite{GabasovDmitrukKirillova15a} и в применении к задачам стабилизации нелинейных объектов согласно теории  управления по прогнозирующей модели \cite{Mayne}.

В настоящей главе приводятся основные положения поведенческой теории линейных систем, используемые в работе. Также объясняется принцип управления в режиме реального времени в применении к реализации оптимальных обратных связей в задачах оптимального управления с конечным горизонтом планирования \cite{GabasovDmitrukKirillova15a}.
\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
\section{Оптимальное управление в  реальном времени}\label{1sec:optimal-control}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Рассмотрим задачу оптимального управления
\begin{equation} \label{1problem}
    c^Tx(t_f)\to \min,
    \end{equation}
$$
    \dot{x}=A(t)x+B(t)u,\ x(t_0)=x_0^*,
    $$
$$
    x(t_f) \in X_f,\quad  u(t)\in U, \quad  t\in T,
    $$
где  $X_f=\{x\in \mathbb{R}^n: g_*\leq Hx \leq g^*\}$ --- терминальное
множество, $H\in \mathbb{R}^{m\times n}$, $g_*,$ $g^* \in \mathbb{R}^m$;
$U=\{u\in \mathbb{R}^r: u_*\le u\le u^*\}$ --- множество доступных значений
управляющего воздействия.

\begin{definition}  Управляющее воздействие $u(t)\in U$, $t\in T$, называется программой, если соответствующая ему
траектория $x(t)$, $t\in T$, математической модели (\ref{1problem}) удовлетворяет
условию $x(t_f)\in X_f$.
\end{definition}

\begin{definition}  Программа $u^0(t)$, $t\in T$,
называется оптимальной (программным решением задачи (\ref{1problem})), если на соответствующей ей (оптимальной) траектории $x^0(t)$, $t\in T$, выполняется равенство
$$
    c^Tx^0(t_f) = \min_u c^Tx(t_f),
     $$
где минимум ищется среди всех программ.
\end{definition}

........

\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
\section{Теория управления по прогнозирующей модели}\label{1sec:MPC}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

В западной литературе (см. \cite{Keerthi, Mayne2000, Mayne}) управление в реальном времени представлено теорией управления по прогнозирующей модели --- Model Predictive Control (MPC), также называемая Receding Horizon Control (RHC). Основными приложениями теории являются задачи стабилизации динамических систем. Современная теория нелинейного MPC предлагает основанные на решении задач оптимального управления методы построения обратных связей для нелинейных объектов.

Главная идея MPC --- использование математической модели управляемого процесса в пространстве состояний для предсказания и оптимизации будущего поведения системы. Поясним на примере модели нелинейного процесса управления
\begin{equation}\label{sys2}
    \dot x = f(x,u)
    \end{equation}
где $x=x(t)\in \mathbb{R}^n$ --- состояние модели  в момент времени $t$; $u=u(t)\in
\mathbb{R}^r$ --- значение управляющего воздействия; $f:\mathbb{R}^n \to \mathbb{R}^r$ --- заданная функция, обеспечивающая существование и единственность решения (\ref{sys2}) при любом допустимом управляющем воздействии.


........
\end{comment}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5