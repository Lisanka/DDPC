\chapter{ПОСТАНОВКА ЗАДАЧИ ПРИ НАЛИЧИИ МОДЕЛИ СИСТЕМЫ}\label{chap2}
В данной главе мы сформулируем рассматриваемую задачу управления линейной системой с известной минимальной реализацией в пространстве состояний. Также будет приведён возможный метод её решения.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Постановка задачи}\label{2sec:problem-formulation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Рассмотрим линейную стационарную систему $G$ дискретного времени, минимальная реализация которой $(A,B,C,D)$.
\begin{equation}
x(t+1) = Ax(t) + Bu(t), \quad x(0) = x_0 \label{model}
\end{equation}
$$y(t) = Cx(t) + Du(t)$$
$$t = 0, \cdots, T.$$
Здесь $ x(t) \in \mathbb{R}^n, u(t) \in \mathbb{R}^m, y(t) \in \mathbb{R}^p$ -- состояние системы, управляющее воздействие и выходной сигнал в момент времени $t$ соответственно.

На сигналы наложены следующие ограничения: 
\begin{equation} \label{constraints}
u(t) \in U, \quad y(t) \in Y(t), \quad t = 0, \cdots, T-1,
\end{equation} где $ U = \{u \in \mathbb{R}^m\ | \quad u_{min} \leq u \leq u_{max} \}, $ $Y(t) = \{ y \in \mathbb{R}^p |\quad G(t)y \leq g(t) \},$ $G(t) \in \mathbb{R}^{q \times p}, g(t) \in \mathbb{R}^q.$

\bigskip
В последующем мы считаем, нам доступны лишь неточно измеренные выходные сигналы $\tilde{y}(t)$, т.е. $ \tilde{y}(t) = y(t) + \xi(t)$, где $y(t)$ -- точное значение выходного сигнала в соответствии с \ref{model}, а $\xi(t)$ -- ограниченная ошибка измерения в момент времени $t$. 

Начальное состояние $x_0$ и величина погрешности $\xi(t)$ достоверно неизвестны, однако полагаем их в дальнейшем принадлежащими известным множествам: $x_0 \in \mathcal{X}_0, \xi(t) \in \mathit{\Xi},$ где
$\mathcal{X}_0 = \{ x\in \mathbb{R}^n : x_{min} \leq x \leq x_{max} \}$, $\mathit{\Xi} = \{ \xi \in \mathbb{R}^p, \norm{\xi}_{\infty} \leq \varepsilon \}$.

Задачей управления является минимизация следующего квадратичного критерия качества
$$\sum\limits_{t = 0}^{T-1} \norm{u(t)}^2,$$
на множестве допустимых управляющих воздействий $u(t) \in U$, гарантирующих соблюдение ограничений на выходные сигналы $y(t) \in Y(t)$  при \textit{всех} возможных реализациях измерительных ошибок $\xi(t) \in \mathit{\Xi}$ и начального условия $x_0 \in X.$

\begin{definition}
Назовём состояние $x(\tau)$ \textit{согласующимся} c траекторией $\{u_\tau, \tilde{y}_\tau\}$, если существуют такие допустимые начальное состояние $x_0 \in X_0$ и измерительные ошибки $\xi(t) \in \mathit{\Xi}, t = 0, \ldots, \tau - 1$, что
$$x(\tau) = x(\tau |x_0, u_\tau),$$
$$\tilde{y}(t) = Cx(t | x_0, u_t) + Du(t) + \xi(t), \quad t = 0, \ldots, \tau -1,$$
\end{definition}
где $x(t|x_0, u_t)$ обозначает состояние, в которое система \ref{model} приходит в момент $t$, двигаясь из начальной точки $x(0) = 0$ под действием управляющих воздействий $u_t$.
Обозначим как $X(\tau, u_\tau, y_\tau)$ множество всех состояний $x(\tau)$, согласующихся с~$\{u_\tau, y_\tau\}$.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Возможный метод решения}\label{2sec:control-strategy}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Изложим стратегию оптимального управления, предложенную в [?? на что тут сослаться].

В каждый момент времени $\tau = 0, \ldots, T-$, обладая знанием траектории $\{u_\tau, y_\tau\}$,  мы решаем следующую задачу оптимального управления по разомкнутому контуру:
\begin{equation}\label{oc-at-tau}
\min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
\end{equation}
$$ x(t+1) = Ax(t) + Bu(t),$$
$$ y(t) = Cx(t) + Du(t),$$
$$u(t) \in U, \quad y(t) \in Y(t) \quad \forall x(\tau) \in X(\tau, u_\tau, \tilde{y}_\tau)$$
$$t = \tau, \cdots, T-1.$$
Дабы подчеркнуть, что $\{u_\tau, y_\tau\}$ в этом случае обозначает апостериорную на момент $\tau$, \textit{прошлую} траекторию, тогда как $u(t), y(t), \tau \leq t \leq T$ означают возможные входные и выходные сигналы в будущем, в дальнейшем будем обозначать $\{u_\tau, y_\tau\}$ как $\{u_\tau^p, y_\tau^p\}.$  

Пусть $u^0(t|\tau, u_\tau^p, \tilde{y}_\tau^p), t = \tau, \ldots, T-1$ --  оптимальное управляющее воздействие по выходному сигналу для задачи \ref{oc-at-tau}, тогда в момент $\tau$ мы применяем к систему лишь первое значение $u^p(\tau) = u^0(\tau|\tau, u_\tau^p, y_\tau^p)$, после чего переходим к следующей задаче управления, уже в момент $\tau + 1$, на единицу уменьшившимся горизонтом планирования и обогатившимся знанием о поведении системы в лице более длинной траектории $\{u_{\tau+1}^p, \tilde{y}_{\tau+1}^p\}.$

Далее, воспользовавшись принципом разделения для линейных систем, мы разделяем задачу \ref{oc-at-tau} на несколько задач оптимального наблюдения и одну задачу детерминированного оптимального управления.

Так, представив состояние $x(t)$ и выходной сигнал $y(t)$ в виде $x(t) = x_0(t) + \hat{x}(t),$ $y(t) = y_0(t) + \hat{y}(t)$, где $x_0(t), y_0(t)$ соотвенствуют состоянию и выходу номинальной системы с нулевым начальным состоянием
$$x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0$$
$$y_0(t) = Cx_0(t) + Du(t), \quad t = \tau, \ldots, T-1,$$
а $\hat{x}(t), \hat{y}(t)$ соответствуют состоянию и выходу неуправляемой системы с неопределённым начальным состоянием
$$\hat{x}(t) = A\hat{x}(t), \hat{x}(\tau) \in X(\tau, u_\tau, y_\tau)$$
$$\hat{y}(t) = C\hat{x}(t), t = \tau, \ldots, T-1,$$
позволяет рассмотреть ограничение на выходные сигналы \ref{constraints} в виде
$$G(t)(y_0(t) + \hat{y}(t)) \leq g(t), \quad \forall x(\tau) \in X(\tau, u_\tau, y_\tau)$$
и влечёт естественное ужесточённое условие на $y_0(t)$, удовлетворение которого будет гарантировать допустимость соответствующего управляющего воздействия:
\begin{equation}\label{model-chi}
y_0(t) \in Y_0(t | \tau) = \{y \in \mathbb{R}^p : G(t)y \leq g(t) - \xi(t|\tau)\},
\end{equation}
где каждая компонента вектора $\xi(t | \tau)$ соответствет наихудшей реализации состояния $x(\tau)$:
\begin{equation}
\xi_i(t | \tau) = \max\limits_z G_i(t)\hat{y}(t),
\end{equation}
$$\hat{x}(s+1) = A\hat{x}(s), \hat{x}(\tau) = z,$$
$$y(s) = C\hat{x}(s), s = \tau, \ldots, t,$$
$$z \in X(\tau, u_\tau, y_\tau),$$
где $G_i(t)$ обозначает $i-$ю строку матрицы $G(t).$

\bigskip
После вычисления всех оценок $\chi(t), t = \tau, \ldots, T-1$,
оптимальное управляющее воздействие получаем как решение следующей детерминированной задачи оптимального управления:
\begin{equation}\label{model-det-oc}
\min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
\end{equation}
$$x_0(t+1) = Ax_0(t) + Bu(t), x_0(\tau) = 0,$$
$$y_0(t) = Cx_0(t) + Du(t),$$
$$u(t) \in U, y_0(t) \in Y_0(t | \tau),$$
$$t = \tau, \ldots, T-1.$$
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bigskip
В настоящей главе мы сформулировали изучаемую задачу оптимального гарантирующего управления линейной стационарной системой дискретного времени по неточным выходным сигналам. Рассмотрена стратегия построения оптимальных обратных связей по выходу в реальном времени. Было продемонстрировано, как данная задача естественным образом разделяется на несколько задач оптимального наблюдения и одну детерминированную задачу оптимального управления. 
