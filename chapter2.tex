\chapter{ПОСТАНОВКА ЗАДАЧИ ПРИ НАЛИЧИИ МОДЕЛИ СИСТЕМЫ}\label{chap2}
В данной главе будет сформулирована рассматриваемая задача управления линейной системой с известной минимальной реализацией в пространстве состояний. Также будет приведен возможный метод ее решения.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Постановка задачи}\label{2sec:problem-formulation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Рассмотрим линейную стационарную систему $G$ дискретного времени, минимальная реализация которой $(A,B,C,D)$.
\begin{equation}
x(t+1) = Ax(t) + Bu(t), \quad x(0) = x_0, \label{model}
\end{equation}
$$y(t) = Cx(t) + Du(t),$$
$$t = 0, \ldots, T-1.$$
Здесь $ x(t) \in \mathbb{R}^n, u(t) \in \mathbb{R}^m, y(t) \in \mathbb{R}^p$ -- состояние системы, управление и выходной сигнал в момент времени $t$ соответственно.

На сигналы наложены следующие ограничения: 
\begin{equation} \label{constraints}
u(t) \in U, \quad y(t) \in Y(t), \quad t = 0, \ldots, T-1,
\end{equation} где $ U = \{u \in \mathbb{R}^m\ : u_{\min} \leq u \leq u_{\max} \},$ $Y(t) = \{ y \in \mathbb{R}^p : G(t)y \leq g(t) \},$ $G(t) \in \mathbb{R}^{q \times p}, \quad g(t) \in \mathbb{R}^q.$

\bigskip
В последующем будем считать, что в момент времени $\tau$ доступны лишь неточно измеренные выходные сигналы $ {\tilde{y}^p(t) = y^p(t) + \xi(t),}$ $ {t = 0, \ldots, \tau - 1}$, где $y^p(t)$ --- точное значение выходного сигнала в соответствии с (\ref{model}), а $\xi(t)$ --- ограниченная ошибка измерения в момент времени ${t = 0, \ldots, \tau -1}$. Верхний индекс $p$ подчеркивает, что измеренные сигналы относятся к конкретной "прошлой"\ (past) траектории.

Начальное состояние $x_0$ и величина погрешности $\xi(t)$ достоверно неизвестны, однако полагаем их в дальнейшем принадлежащими известным множествам: $x_0 \in \mathcal{X}_0, $ $\xi(t) \in \mathit{\Xi},$ где
$\mathcal{X}_0 = \{ x\in \mathbb{R}^n : x_{min} \leq x \leq x_{max} \}$, $\mathit{\Xi} = \{ \xi \in \mathbb{R}^p : \norm{\xi}_{\infty} \leq \varepsilon \}$.

Задачей управления является минимизация следующего квадратичного критерия качества
$$\sum\limits_{t = 0}^{T-1} \norm{u(t)}^2,$$
на множестве допустимых управляющих воздействий ${u(t) \in U}$, гарантирующих соблюдение ограничений на выходные сигналы ${y(t) \in Y(t)}$  при \textit{всех} возможных реализациях измерительных ошибок ${\xi(t) \in \mathit{\Xi}}$ и начального условия $x_0 \in X.$

\begin{definition}
Назовем состояние $x(\tau)$ \textit{согласующимся} c траекторией $\{u_\tau^p, \tilde{y}_\tau^p\}$, если существуют такие допустимые начальное состояние $x_0 \in X_0$ и ошибки измерения $\xi(t) \in \mathit{\Xi}, \quad t = 0, \ldots, \tau - 1$, что
$$x(\tau) = x(\tau |x_0, u_\tau^p),$$
$$\tilde{y}^p(t) = Cx(t | x_0, u_t^p) + Du^p(t) + \xi(t), \quad t = 0, \ldots, \tau -1,$$
\end{definition}
где $x(t|x_0, u_t^p)$ обозначает состояние, в которое система (\ref{model}) приходит в момент~$t$, двигаясь из начальной точки $x(0) = x_0$ под воздействием управления $u_t^p$.
Обозначим как $X(\tau, u_\tau^p, \tilde{y}_\tau^p)$ множество всех состояний $x(\tau)$, согласующихся с~$\{u_\tau^p, \tilde{y}_\tau^p\}$.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Возможный метод решения}\label{2sec:control-strategy}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Изложим стратегию оптимального управления, предложенную в \cite{} ?? на что тут сослаться.

В каждый момент времени $\tau = 0, \ldots, T-1$, обладая знанием неточной траектории $\{u_\tau^p, \tilde{y}_\tau^p\}$,  решаем следующую задачу оптимального программного управления:
\begin{equation}\label{oc-at-tau}
\min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
\end{equation}
$$ x(t+1) = Ax(t) + Bu(t),$$
$$ y(t) = Cx(t) + Du(t),$$
$$u(t) \in U, \quad y(t) \in Y(t) \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p)$$
$$t = \tau, \ldots, T-1.$$

Пусть $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p), t = \tau, \ldots, T-1$ --- оптимальное управление по выходному сигналу для задачи (\ref{oc-at-tau}), тогда в момент $\tau$ подаем на вход лишь первое значение $u^p(\tau) = u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p)$, после чего переходим к следующей задаче оптимального программного управления, уже в момент $\tau + 1$, на единицу уменьшившимся горизонтом планирования и обогатившимся знанием о поведении системы в лице более длинной траектории $\{u_{\tau+1}^p, \tilde{y}_{\tau+1}^p\}.$

\bigskip
Далее, воспользовавшись принципом разделимости для линейных систем, разделяем задачу (\ref{oc-at-tau}) на несколько задач оптимального наблюдения и одну задачу детерминированного оптимального управления.

Так, представив состояние $x(t)$ и выходной сигнал $y(t)$ в виде $x(t) = x_0(t) + \hat{x}(t),$ $y(t) = y_0(t) + \hat{y}(t)$, где $x_0(t), y_0(t)$ соотвенствуют состоянию и выходу номинальной системы с нулевым начальным состоянием
$$x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0,$$
$$y_0(t) = Cx_0(t) + Du(t), \quad t = \tau, \ldots, T-1,$$
а $\hat{x}(t), \hat{y}(t)$ соответствуют состоянию и выходу неуправляемой системы с неопределенным начальным состоянием
$$\hat{x}(t) = A\hat{x}(t), \quad \hat{x}(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p)$$
$$\hat{y}(t) = C\hat{x}(t), \quad t = \tau, \ldots, T-1,$$
позволяет рассмотреть ограничение на выходные сигналы (\ref{constraints}) в виде
$$G(t)(y_0(t) + \hat{y}(t)) \leq g(t), \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),$$
и влечет естественное суженное условие на $y_0(t)$, удовлетворение которого будет гарантировать допустимость выходного сигнала $y(t)$:
\begin{equation}\label{model-chi}
y_0(t) \in Y_0(t | \tau) = \{y \in \mathbb{R}^p : G(t)y \leq g(t) - \chi(t|\tau)\},
\end{equation}
где каждая компонента вектора $\chi(t | \tau)$ соответствет наихудшей реализации состояния $x(\tau)$:
\begin{equation}
\chi_i(t | \tau) = \max\limits_z G_i(t)\hat{y}(t),
\end{equation}
$$\hat{x}(s+1) = A\hat{x}(s), \quad \hat{x}(\tau) = z,$$
$$y(s) = C\hat{x}(s), \quad s = \tau, \ldots, t,$$
$$z \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),$$
где $G_i(t)$ обозначает $i$--ю строку матрицы $G(t).$

\bigskip
После вычисления всех оценок $\chi(t|\tau), \quad t = \tau, \ldots, T-1$,
оптимальное управление $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p)$ получаем как решение следующей детерминированной задачи оптимального управления:
\begin{equation}\label{model-det-oc}
\min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
\end{equation}
$$x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0,$$
$$y_0(t) = Cx_0(t) + Du(t),$$
$$u(t) \in U, \quad y_0(t) \in Y_0(t | \tau),$$
$$t = \tau, \ldots, T-1.$$
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bigskip
В настоящей главе была поставлена изучаемая задача оптимального гарантирующего управления линейной стационарной системой дискретного времени по неточным выходным сигналам. Рассмотрена стратегия построения оптимальных обратных связей по выходу в реальном времени. Было продемонстрировано, как данная задача естественным образом разделяется на несколько задач оптимального наблюдения и одну детерминированную задачу оптимального управления. 
