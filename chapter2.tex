\chapter{НАЗВАНИЕ ГЛАВЫ}\label{chap2}
В данной главе мы применим поведенческий подход к конкретной задаче оптимального управления. Будем предложен метод управления, опирающийся лишь на траектории системы, не использующий никаких иных данных данных, как то параметрическое представление системы. Предложенный метод сопровождён численным примером.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Постановка задачи}\label{2sec:problem-formulation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Рассмотрим дискретную линейную стационарную систему $G$, минимальная реализация которой $(A,B,C,D)$.
\begin{equation}
x(t+1) = Ax(t) + Bu(t), \quad x(0) = x_0 \label{model}
\end{equation}
$$y(t) = Cx(t) + Du(t)$$
$$t = 0, \cdots, T$$
Здесь $ x(t) \in \mathbb{R}^n, u(t) \in \mathbb{R}^m, y(t) \in \mathbb{R}^p$ -- состояние системы, управляющее воздействие и выходной сигнал в момент времени $t$ соответственно.

На сигналы наложены следующие ограничения: 
\begin{equation} \label{constraints}
u(t) \in U, \quad y(t) \in Y(t), \quad t = 0, \cdots, T-1,
\end{equation} где $ U = \{u \in \mathbb{R}^m\ : \quad u_{min} \leq u \leq u_{max} \}$, $Y(t) = \{ y \in \mathbb{R}^p: G(t)y \leq g(t) \},$ $G(t) \in \mathbb{R}^{q \times p}, g(t) \in \mathbb{R}^q$.

В последующем мы считаем, нам доступны лишь неточно измеренные выходные сигналы $\tilde{y(t)}$, т.е. $ \tilde{y(t)} = y(t) + \xi(t)$, где $y(t)$ -- точное значение выходного сигнала, а $\xi(t)$ -- ограниченная ошибка измерения в момент времени $t$. Начальное состояние $x_0$ и величина погрешности достоверно неизвестны, однако полагаем их в дальнейшем принадлежащим известным множествам: $x_0 \in \mathcal{X}_0, \xi(t) \in \mathit{\Xi}$, где
$\mathcal{X}_0 = \{ x\in \mathbb{R}^n : x_{min} \leq x \leq x_{max} \}$, $\mathit{\Xi} = \{ \xi \in \mathbb{R}^p, \norm{\xi}_{\infty} \leq \varepsilon \}$.

Задачей управления является минимизация следующего квадратичного критерия качества
$$\sum\limits_{t = 0}^{T-1} \norm{u(t)}^2,$$
при гарантированном удовлетворении условий на управляющее воздействие и выходные сигналы, т.е. при удовлетворении этих условий при \textit{всех} возможных реализациях измерительных ошибок и начального условия.

\begin{definition}
Назовём состояние $x(\tau)$ \textit{согласующимся} c траекторией ${u_\tau, y_\tau}$, если существуют такие допустимые начальное состояние $x_0 \in X_0$ и измерительные ошибки $\xi(t) \in \Xi, t = 0, \ldots, \tau - 1$, что
$$x(\tau) = x(\tau |x_0, u_\tau),$$
$$y(t) = Cx(t | x_0, u_t) + Du(t) + \xi(t), \quad t = 0, \ldots, \tau -1$$
\end{definition}
Обозначим как $X(\tau, u_\tau, y_\tau)$ множество всех состояний $x(\tau)$, согласующихся с $\{u_\tau, y_\tau\}$.

Изложим стратегию оптимального управления, предложенную в [?? на что тут сослаться].
В каждый момент времени $\tau = 0, \ldots, T-$ мы решаем следующую задачу оптимального управления по разомкнутому контуру:
\begin{equation}\label{oc-at-tau}
\min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
\end{equation}
$$ x(t+1) = Ax(t) + Bu(t),$$
$$ y(t) = Cx(t) + Du(t),$$
$$u(t) \in U, \quad y(t) \in Y(t) \quad \forall x(\tau) \in X(\tau, u_\tau, y_\tau)$$
$$t = \tau, \cdots, T-1.$$
Пусть $u^0(t|\tau, u_\tau^p, y_\tau^p), t = \tau, \ldots, T-1$ --  оптимальное управляющее воздействие для задачи \ref{oc-at-tau}, тогда в момент $\tau$ мы применяем к систему лишь первое значение$u^p(\tau) = u^0(\tau|\tau, u_\tau^p, y_\tau^p)$, после чего переходим к следующей задаче управления в момент $\tau + 1$, на единицу уменьшившимся горизонтом планирования и обогатившимся знанием о прошлой траектории $\{u_{\tau+1}^p, y_{\tau+1}^p\}.$

Далее, воспользовавшись принципом разделения для линейных систем, мы разделяем задачу \ref{oc-at-tau} на несколько задач оптимального наблюдения и одну задачу детерминированного оптимального управления.
Так, представив состояние $x(t)$ и выходной сигнал $y(t)$ в виде $x(t) = x_0(t) + \hat{x}(t),$ $y(t) = y_0(t) + \hat{y}(t)$, где $x_0(t), y_0(t)$ соотвенствуют состоянию и выходу номинальной системы с нулевым начальным состоянием
$$x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0$$
$$y_0(t) = Cx_0(t) + Du(t), \quad t = \tau, \ldots, T-1,$$
а $\hat{x}(t), \hat{y}(t)$ соответствуют состоянию и выходу неуправляемой системы с неопределённым начальным состоянием
$$\hat{x}(t) = A\hat{x}(t), \hat{x}(\tau) \in X(\tau, u_\tau, y_\tau)$$
$$\hat{y}(t) = C\hat{x}(t), t = \tau, \ldots, T-1.$$
Разделение наблюдения и управления позволяет рассмотреть $t$ выходной сигнал теперь рассматриваем в виде 
$$G(t)(y_0(t) + \hat{y}(t)) \leq g(t), \quad \forall x(\tau) \in X(\tau, u_\tau, y_\tau)$$
и влечёт естественное ужесточённое условие на $y_0(t)$, удовлетворение которого будет гарантировать допустимость управления:
\begin{equation}\label{model-chi}
y_0(t) \in Y_0(t | \tau) = \{y \in \mathbb{R}^p : G(t)y \leq g(t) - \xi(t|\tau)\},
\end{equation}
где каждая компонента вектора $\xi(t | \tau)$ соответствет наихудшей реализации состояния $x(\tau)$:
$$\xi_i(t | \tau) = \max\limits_z G_i(t)\hat{y}(t),$$
$$\hat{x}(s+1) = A\hat{x}(s), \hat{x}(\tau) = z,$$
$$y(s) = C\hat{x}(s), s = \tau, \ldots, t,$$
$$z \in X(\tau, u_\tau, y_\tau),$$
где $G_i(t)$ обозначает $i-$ю строку матрицы $G(t).$
После вычисления всех оценок $\chi(t), t = \tau, \ldots, T-1$,
оптимальное управляющее воздействие получаем как решение следующей детерминированной задачи оптимального управления:
\begin{equation}\label{model-det-oc}
\min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
\end{equation}
$$x_0(t+1) = Ax_0(t) + Bu(t), x_0(\tau) = 0,$$
$$y_0(t) = Cx_0(t) + Du(t),$$
$$u(t) \in U, y_0(t) \in Y_0(t | \tau),$$
$$t = \tau, \ldots, T-1.$$
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


 
