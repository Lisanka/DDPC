\chapter{ЧИСЛЕННЫЙ ПРИМЕР}\label{chap4}
Применим изложенный метод для управления системой 
$$x(t+1) = Ax(t) + Bu(t), x(0) = x_0,$$
$$y(t) = Cx(t) + Du(t), t= 0, \ldots, T$$
размерности $n = 3$ с одним входом и одним выходом,
ограничениями $-1 \leq u(t) \leq 1, \quad -1 \leq y(t) \leq 1, \quad t = \tau, \ldots, T$. Момент начала управления $\tau = n = 3,$ горизонт планирования $T = 11$. Длина априорной траектории $T^d$ должна быть не меньше $2(n+T) = 28$, дабы удовлетворить требование устойчивой возбуждённости порядка $28$.  

Сначала были сгенерированы матрицы $A, B, C, D$, априорная траектория $\{u^d, y^d\}$ минимальной достаточной длины $T^d = 2(n + T) = 28$ и начало управляемой траектории $\{u^p_2, y^p_2\}$  таким образом, что при $\varepsilon = 0.002$ номинальная задача оптимального наблюдения \ref{estimation-lp} решаема. Это даёт нам гарантию того, что для любых векторов ошибок измерения, ограниченных покомпонентно числом $\frac{\varepsilon}{2} = 0.001$ задача наблюдения \ref{estimation-lp} также будет иметь решение, согласно Лемме \ref{estimation-guarantees}. И действительно, во всех 100 случайным образом сгенерированных векторов ошибок, компоненты которых равномерно распределены в $[-\frac{\varepsilon}{2}, \frac{\varepsilon}{2}]$, как задача оптимального наблюдения так и задача оптимального управления имели решение. А вот уже при ошибках, равномерно распределённых в $[-\varepsilon, \varepsilon]$, из 100 экспериментов 96 были успешны -- что, впрочем, также хороший показатель для случаев,где приведённая в Лемме \ref{estimation-guarantees} оценка не даёт никаких гарантий. 

Ниже приведены графики входной и выходной частей траектории для одного из этих 100 экспериментов, в котором сгенерированы следующие данные:  
 
$$A = \begin{pmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
-0.3 & -1.4 & -1.5\\
\end{pmatrix}, \quad 
B = \begin{pmatrix}
0 \\
0 \\
1\\
\end{pmatrix},
$$
$$C = \begin{pmatrix}
-1.5 & 1.1 & 0.7 \\
\end{pmatrix}, \quad
D = \begin{pmatrix}
-1
\end{pmatrix},$$
$$u_3^p = \begin{pmatrix}
   0.548790107621063 \\
   0.113517729294018 \\
   0.896876747586256 \\
\end{pmatrix},
y_3^p = \begin{pmatrix}
  -1.766082539002111 \\
  -0.170898268737663 \\
  -1.445062715844881 \\
\end{pmatrix}
$$

\begin{center}
\includegraphics[scale = 0.8]{uopt.eps}
\includegraphics[scale = 0.8]{yopt.eps}
\end{center}
Значение критерия качества составляет $4.341312541105730$ на первой итерации, $4.338581216206245$ -- на последней.

.....................................
................................
Вопрос: надо ли включать в приложение листинг программы?
%TODO is listing needed?
%\lstinputlisting[language=Matlab]{ddpc.m}